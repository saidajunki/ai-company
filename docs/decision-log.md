# 意思決定ログ（Decision Log）

このファイルは「会社としての意思決定」を蓄積するためのログ。

## フォーマット

```
- Date: YYYY-MM-DD
  Decision: （何を決めたか）
  Why: （なぜ）
  Scope: （影響範囲）
  Revisit: （見直し条件）
```

## 決定事項

- Date: 2026-02-15
  Decision: 10分レポートはSlackチャンネル `C0AF21AFC14` に毎回新規投稿する
  Why: 展開が速い前提で、定期的に状況を追いたい
  Scope: 報告/運用
  Revisit: ノイズが多すぎる場合はフォーマットや頻度を調整

- Date: 2026-02-15
  Decision: 承認はSlackリアクションで行う（✅=承認 / ❌=却下）
  Why: Creatorの介入を最小化し、素早く承認フローを回すため
  Scope: 承認/運用
  Revisit: 誤操作が多ければ運用を見直す

- Date: 2026-02-15
  Decision: 10分レポートは厳密でなくてよい（キリが悪ければスキップ可、±5分程度のズレを許容）
  Why: 自律性と作業の連続性を優先したい
  Scope: 報告/運用
  Revisit: 状況把握が難しければルールを厳密化

- Date: 2026-02-15
  Decision: 直近60分の概算コスト上限を `$10 / 60分` とする
  Why: 展開が速い前提で、時間あたりでコストを管理したい
  Scope: 予算/実験頻度
  Revisit: 上限が低すぎ/高すぎる場合は変更

- Date: 2026-02-15
  Decision: 成果物は原則公開する（実験としてAPIキー等の公開も許容する）
  Why: 確認が簡単で、制限でAIの行動範囲が狭まるのを避けたい
  Scope: 公開/運用
  Revisit: 課金事故や運用上の問題が顕在化した場合は見直す

- Date: 2026-02-15
  Decision: 会社の隔離単位は「1コンテナ=1会社」（会社に1台PCを渡すイメージ）とする
  Why: 既存システムに影響を出しにくく、クリーンアップしやすい
  Scope: 実行環境/運用
  Revisit: 隔離強度が不足する場合はVM相当へ

- Date: 2026-02-15
  Decision: 社長AIを含む全エージェントは会社コンテナ内で生成/稼働させる（コンテナ外にエージェントを置かない）
  Why: 権限境界を会社コンテナに閉じたい
  Scope: 実行環境/権限
  Revisit: 例外が必要になった場合は再検討

- Date: 2026-02-15
  Decision: DB等のために別コンテナを増やさず、必要なら会社コンテナ内で立てる
  Why: 会社に“1台PC”のイメージでシンプルに運用したい
  Scope: 実行環境/運用
  Revisit: 会社の複雑性が上がったら再検討

- Date: 2026-02-15
  Decision: コンテナ作成後、社長AIの初期起動は人為的に行う（ブートストラップ）
  Why: 会社コンテナ内に社長AIを確実に作るため
  Scope: 初期手順/運用
  Revisit: 自動化が必要になったら再検討

- Date: 2026-02-15
  Decision: cronは基本使わない（自律性を優先）。ただし「20分レポートなし」の監視/叩き起こし用途では使ってよい
  Why: 起動トリガーを外部スケジューラに寄せたくないが、ハング検知は必要
  Scope: 実行/運用
  Revisit: 常駐監視の方が良ければ置き換える

- Date: 2026-02-15
  Decision: 20分以上レポートが来ない場合、叩き起こしを行い、同時にSlackへ通知する
  Why: ハング/停止を早期に検知し、人間が状況を把握しやすくする
  Scope: 異常系/運用
  Revisit: 通知がうるさければ条件や頻度を調整

- Date: 2026-02-15
  Decision: 叩き起こしの監視はSlack投稿ではなくheartbeatファイル更新で判定する（例: `companies/<company_id>/state/heartbeat.json`）
  Why: 10分レポートはズレ/スキップがあり得るため、稼働検知は別軸にしたい
  Scope: 異常系/運用
  Revisit: 誤検知が多ければ閾値や信号を調整

- Date: 2026-02-15
  Decision: 叩き起こしの監視/実行主体はホスト側の最小watchdogとする（会社コンテナ外）
  Why: 会社コンテナがフリーズしても監視が死なないようにするため
  Scope: 異常系/運用
  Revisit: 運用形態が変われば再検討

- Date: 2026-02-15
  Decision: 叩き起こしは(A)会社コンテナ内のmanager再起動→(B)会社コンテナ再起動の順で行う
  Why: 既存の社長AIを回復させつつ、最終手段として環境ごと復旧できるようにする
  Scope: 異常系/運用
  Revisit: 実運用で失敗パターンが見えたら調整

- Date: 2026-02-15
  Decision: コスト上限を超えない限り、異常があっても停止より回復/継続を優先する
  Why: 実験前提で止めずに回したい
  Scope: 異常系/運用
  Revisit: 無限ループ等で価値が出ない場合は停止条件を追加

- Date: 2026-02-15
  Decision: 台帳の暫定保存先は `companies/<company_id>/ledger/events.ndjson` とする
  Why: 追記が簡単で、後から移行もしやすい
  Scope: 台帳/運用
  Revisit: クエリや集計が辛くなったらSQLite等に移行

- Date: 2026-02-15
  Decision: 会社憲法の変更は、AIが提案してよいが適用はCreator承認が必要
  Why: 迷走防止の最上位ルールを勝手に書き換えさせないため
  Scope: 記憶/統治
  Revisit: 運用しながら最適な手続きを調整
